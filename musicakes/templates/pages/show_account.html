{% extends "layouts/layout.html" %}
{% block title %}{% endblock %}
{% block content %}
<div class = "container">

	<div class="row pt-4 mt-4">
		<div class="col-md-2 border-right">
			<meta id="user-id" data-id="{{ userinfo.id }}">

			<h4>
				Username
			</h4>

			<p>{{ userinfo.username }}</p>

			<div class="mb-4">
				<h4>
					Profile Picture
				</h4>
				<form method="post" onsubmit="return false">
					<div class = "display-picture my-4">
					{% if userinfo.profile_picture is none %}
						<img src="/static/img/musicakes.png" id="image-preview" />
					{% else %}
						<img src="{{ userinfo.profile_picture }}" id="image-preview" />
					{% endif %}

					<label for="image-input" class="upload-img-btn">
						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-upload" viewBox="0 0 16 16">
							<path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
							<path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708l3-3z"/>
						</svg>
					</label>
	        <input type="file" id="image-input" accept="image/png, image/jpg, image/jpeg" >
					<input type="hidden" id="csrf_token" value="{{ csrf_token() }}" />
					</div>
					<input type="button" id="edit-profile-picture-btn" value="Save image" class="btn btn-sm btn-outline-secondary mt-3">

				</form>
			</div>

			{% if userinfo.artist_name is not none %}
			<h4>
				Artist profile
			</h4>

			<p><a href ="../artists/{{ userinfo.artist_id }}">{{ userinfo.artist_name}}</a></p>

			{% endif %}

			<small>
				Member since {{ userinfo.created_on }}
			</small>

		</div>

		<div class="col-md-10">

			<div>
				<ul class="nav nav-tabs flex-row">
          <li class="nav-item-tab">
            <a class="nav-link active" data-toggle="tab" href="#tab-1"">Purchases</a>
          </li>

					{% if userinfo.artist_id is number %}
          <li class="nav-item-tab">
            <a class="nav-link" data-toggle="tab" href="#tab-2">Deployments</a>
          </li>
					{% endif %}

        </ul>
			</div>

		<div class="tab-content">
			<div class="tab-pane fade show active mt-3" id="tab-1">
				<div>
					<h4>Pending Transactions</h4>
					{% if pending_transactions|length > 0 %}
					<table class="table table-bordered">
						<thead>
							<tr>
								<th scope="col">Transaction Hash</th>
								<th scope="col">Purchase</th>
								<th scope="col">Submitted on</th>
								<th scope="col">Status</th>
								<th scope="col">Remove</th>
								<th scope="col">Refresh</th>
							</tr>
						</thead>
						<tbody>
						{% for pending_transaction in pending_transactions %}
							<tr>
								<td>{{ pending_transaction.transaction_hash }}</td>
								<td>{{ pending_transaction.purchase_description }}</td>
								<td>{{ pending_transaction.started_on }}</td>
								<td>Pending</td>
								<td style="text-align: center;">
									<a class="remove-txn-btn" href="#" data-transaction-hash="{{ pending_transaction.transaction_hash }}">
									<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
									  <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
									  <path fill-rule="evenodd" d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
									</svg>
									</a>
								</td>
								<td style="text-align: center;">
									<a class="update-txn-btn" href="#" data-transaction-hash="{{ pending_transaction.transaction_hash }}">
									<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-clockwise" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
									  <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
									  <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
									</svg>
									</a>
								</td>
							</tr>
						{% endfor %}
						</tbody>
					</table>
					{% else %}
					<p>You do not have any pending purchases.</p>
					{% endif %}
				</div>

				<div>
					<h4>Latest Transactions</h4>
					{% if transaction_history|length > 0 %}
					<table class="table table-bordered">
						<thead>
							<tr>
								<th scope="col">Transaction Hash</th>
								<th scope="col">Purchase</th>
								<th scope="col">Submitted on</th>
								<th scope="col">Status</th>
								<th scope="col">Remove</th>
							</tr>
						</thead>
						<tbody>
						{% for transaction in transaction_history %}
							<tr>
								<td>{{ transaction.transaction_hash }}</td>
								<td>{{ transaction.purchase_description }}</td>
								<td>{{ transaction.started_on }}</td>
								<td>Confirmed</td>
								<td style="text-align: center;">
									<a class="remove-txn-btn" href="#" data-transaction-hash="{{ transaction.transaction_hash }}">
									<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
									  <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
									  <path fill-rule="evenodd" d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
									</svg>
									</a>
								</td>
							</tr>
						{% endfor %}
						</tbody>
					</table>
					{% else %}
					<p>You have not made any purchases.</p>
					{% endif %}
				</div>
			</div>

			{% if userinfo.artist_id is number %}

			<div class="tab-pane fade mt-3" id="tab-2">
				<div>
					<h4>Pending Deployments</h4>
					{% if pending_deployments|length > 0 %}
					<table class="table table-bordered">
						<thead>
							<tr>
								<th scope="col">Transaction Hash</th>
								<th scope="col">Deployment</th>
								<th scope="col">Submitted on</th>
								<th scope="col">Status</th>
								<th scope="col">Remove</th>
								<th scope="col">Refresh</th>
							</tr>
						</thead>
						<tbody>
						{% for pending_deployment in pending_deployments %}
							<tr>
								<td>{{ pending_deployment.transaction_hash }}</td>
								<td>{{ pending_deployment.release_name }}</td>
								<td>{{ pending_deployment.started_on }}</td>
								<td>Pending</td>
								<td style="text-align: center;">
									<a class="remove-txn-btn" href="#" data-transaction-hash="{{ pending_deployment.transaction_hash }}">
									<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
									  <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
									  <path fill-rule="evenodd" d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
									</svg>
									</a>
								</td>
								<td style="text-align: center;">
									<a class="update-txn-btn" href="#" data-transaction-hash="{{ pending_deployment.transaction_hash }}">
									<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-arrow-clockwise" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
									  <path fill-rule="evenodd" d="M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"/>
									  <path d="M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"/>
									</svg>
									</a>
								</td>
							</tr>
						{% endfor %}
						</tbody>
					</table>
					{% else %}
					<p>You do not have any pending deployments.</p>
					{% endif %}
				</div>

				<div>
					<h4>Latest Deployments</h4>
					{% if deployment_history|length > 0 %}
					<table class="table table-bordered">
						<thead>
							<tr>
								<th scope="col">Transaction Hash</th>
								<th scope="col">Deployment</th>
								<th scope="col">Submitted on</th>
								<th scope="col">Status</th>
								<th scope="col">Remove</th>
							</tr>
						</thead>
						<tbody>
						{% for deployment in deployment_history %}
							<tr>
								<td>{{ deployment.transaction_hash }}</td>
								<td>{{ deployment.release_name }}</td>
								<td>{{ deployment.started_on }}</td>
								<td>Confirmed</td>
								<td style="text-align: center;">
									<a class="remove-txn-btn" href="#" data-transaction-hash="{{ deployment.transaction_hash }}">
									<svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-x-circle" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
									  <path fill-rule="evenodd" d="M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
									  <path fill-rule="evenodd" d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"/>
									</svg>
									</a>
								</td>
							</tr>
						{% endfor %}
						</tbody>
					</table>
					{% else %}
					<p>You have not made any deployments.</p>
					{% endif %}
				</div>
			</div>
			{% endif %}
		</div>

	</div>




</div>
<script type="text/javascript">
  window.appConfig = {
    user_id: $('#user-id').data(),
  }
</script>
<script type="text/javascript" src="{{ url_for('static', filename='js/show_account.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/edit_profile_picture.js') }}"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/image_preview.js') }}"></script>
{% endblock %}
